# Документация проекта

## Описание
Проект представляет собой веб-приложение на Uvicorn для скачивания видео. Основные возможности:
- Скачивание видео с YouTube и других поддерживаемых платформ
- Поддержка HLS потоков
- Интеграция с ffmpeg и yt-dlp
- Отслеживание прогресса загрузки
- Управление загрузками через REST API
- Хранение куков для авторизации
- Локальное хранение загруженных файлов

## Функционал
- Главная страница с базовым интерфейсом
- Поддержка статических файлов (CSS стили)
- Модульная структура с разделением на:
  * Логику приложения (app.py)
  * Статические файлы (static/)
  * Представления (views/)

## Структура проекта
```
.
├── app.py               # Основной файл приложения
├── requirements.txt     # Зависимости
├── cookies.txt          # Хранение куков для авторизации
├── downloads/           # Папка для хранения загруженных файлов
├── static/              # Статические файлы (CSS, JS, изображения)
│   └── style.css        # Стили
├── views/               # Представления
│   └── index.html       # Главная страница
└── README.md            # Документация (этот файл)
```

## Установка и запуск
1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Создайте папку для загрузок:
```bash
mkdir downloads
```

3. Запустите приложение:
```bash
python app.py
```

4. Откройте в браузере:
```
http://localhost:5000
```

## Принцип работы

### Основные компоненты
1. **Загрузчик видео**:
   - Использует yt-dlp для YouTube и Vimeo
   - Использует ffmpeg для HLS потоков
   - Поддерживает прогресс загрузки
   - Хранит файлы в папке downloads/

2. **API сервер**:
   - Starlette для обработки запросов
   - REST API для управления загрузками
   - SSE для потоковой передачи прогресса
   - Логирование всех операций

3. **Интерфейс**:
   - Jinja2 шаблоны для рендеринга страниц
   - Статические файлы (CSS, JS)
   - Отображение прогресса загрузки

### Логика работы
1. Пользователь отправляет URL видео через интерфейс
2. Сервер создает уникальный ID загрузки
3. Запускается отдельный поток для скачивания:
   - Для YouTube/Vimeo используется yt-dlp
   - Для HLS потоков используется ffmpeg
4. Прогресс загрузки обновляется в реальном времени через SSE
5. После завершения файл доступен для скачивания
6. Через 5 минут после скачивания файл автоматически удаляется

### Обработка ошибок
- Логирование всех ошибок в app.log
- Автоматическая очистка логов каждые 24 часа
- Возможность отмены загрузки
- Проверка доступности файлов перед скачиванием

## Автор
Vnedrenec
